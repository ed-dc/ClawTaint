# ClawTaint Configuration Example
# Copy this to clawtaint.yaml and customize

version: "1.0"

# Global settings
global:
  enabled: true
  logLevel: info  # debug, info, warn, error

# Taint level settings
taint:
  # Starting taint level (0-100, 100 = fully trusted)
  initialLevel: 100

  # How much taint decreases per untrusted URL access
  penaltyPerUntrustedUrl: 10

  # How much taint recovers per trusted URL access (0 = no recovery)
  recoveryPerTrustedUrl: 0

  # Minimum taint level (floor)
  minimumLevel: 0

  # Taint thresholds define which restriction tier applies at each level
  thresholds:
    - minTaint: 75
      maxTaint: 100
      tier: permissive    # All shell commands allowed
    - minTaint: 50
      maxTaint: 74
      tier: cautious      # Dangerous commands blocked
    - minTaint: 25
      maxTaint: 49
      tier: restricted    # Only safe commands allowed
    - minTaint: 0
      maxTaint: 24
      tier: lockdown      # ALL shell commands blocked

# Trusted URL patterns (glob syntax)
trustedUrls:
  patterns:
    - "*.github.com"
    - "*.stackoverflow.com"
    - "*.npmjs.com"
    - "*.python.org"
    - "*.mozilla.org"
    - "*.microsoft.com"
    - "*.typescriptlang.org"
    - "*.nodejs.org"
    - "*.developer.mozilla.org"
    # Add your own trusted domains:
    # - "*.your-company.com"
    # - "internal-docs.example.com"

# Shell restriction settings
shellRestrictions:
  # Tool names that are considered shell/terminal tools
  toolNames:
    - Bash
    - shell
    - terminal
    - run_command
    - execute

  # Commands ALWAYS blocked (even at permissive tier)
  alwaysBlocked:
    - "rm -rf /"
    - "mkfs"
    - "dd if="
    - ":(){:|:&};:"
    - "> /dev/sda"

  # Commands blocked at 'cautious' tier and below
  dangerousCommands:
    - "rm -rf"
    - "rm -r"
    - "rmdir"
    - "format"
    - "shutdown"
    - "reboot"
    - "halt"
    - "poweroff"
    - "kill -9"
    - "killall"
    - "pkill"
    - "chmod 777"
    - "chmod -R"
    - "chown -R"
    - "iptables -F"
    - "systemctl stop"
    - "systemctl disable"
    - "DROP TABLE"
    - "DROP DATABASE"
    - "TRUNCATE"
    - "DELETE FROM"
    - "curl | sh"
    - "curl | bash"
    - "wget | sh"
    - "wget | bash"

  # Commands allowed at 'restricted' tier (base command is matched)
  safeCommands:
    - ls
    - dir
    - pwd
    - cd
    - cat
    - head
    - tail
    - echo
    - whoami
    - date
    - uname
    - hostname
    - which
    - grep
    - find
    - tree
    - df
    - du
    - git status
    - git log
    - git diff
    - git branch
    - node --version
    - npm --version
    - python --version
